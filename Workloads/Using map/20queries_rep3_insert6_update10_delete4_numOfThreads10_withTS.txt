CREATE KEYSPACE IF NOT EXISTS amit WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : '3' };
CREATE TABLE IF NOT EXISTS amit.barak (A text, B text, C text, toTS map, currTS map, PRIMARY KEY (A));
INSERT INTO amit.barak (A, B, C, toTS, currTS) VALUES('xia', 'rzz', 'enm', 'htx', 'nlw') USING TIMESTAMP 1;
INSERT INTO amit.barak (A, B, C, toTS, currTS) VALUES('dry', 'krv', 'geb', 'vfo', 'qdg') USING TIMESTAMP 2;
INSERT INTO amit.barak (A, B, C, toTS, currTS) VALUES('ypo', 'uau', 'ggn', 'fny', 'uql') USING TIMESTAMP 3;
INSERT INTO amit.barak (A, B, C, toTS, currTS) VALUES('jxb', 'rdi', 'czn', 'wyc', 'wom') USING TIMESTAMP 4;
INSERT INTO amit.barak (A, B, C, toTS, currTS) VALUES('vhn', 'llf', 'lnj', 'imm', 'vlq') USING TIMESTAMP 5;
INSERT INTO amit.barak (A, B, C, toTS, currTS) VALUES('hmh', 'ezq', 'ovr', 'rkx', 'mat') USING TIMESTAMP 6;
UPDATE amit.barak USING TIMESTAMP 7 SET B = 'kfw' WHERE A = 'dry';
UPDATE amit.barak USING TIMESTAMP 8 SET B = 'fck' WHERE A = 'kfw';
UPDATE amit.barak USING TIMESTAMP 9 SET B = 'mht' WHERE A = 'fck';
UPDATE amit.barak USING TIMESTAMP 10 SET B = 'oli' WHERE A = 'mht';
UPDATE amit.barak USING TIMESTAMP 11 SET B = 'kzl' WHERE A = 'oli';
UPDATE amit.barak USING TIMESTAMP 12 SET B = 'ijg' WHERE A = 'kzl';
UPDATE amit.barak USING TIMESTAMP 13 SET B = 'fad' WHERE A = 'ijg';
UPDATE amit.barak USING TIMESTAMP 14 SET B = 'wrp' WHERE A = 'fad';
UPDATE amit.barak USING TIMESTAMP 15 SET B = 'voi' WHERE A = 'wrp';
UPDATE amit.barak USING TIMESTAMP 16 SET B = 'wbf' WHERE A = 'voi';
DELETE FROM amit.barak USING TIMESTAMP 17 WHERE A='xia';
DELETE FROM amit.barak USING TIMESTAMP 18 WHERE A='wbf';
DELETE FROM amit.barak USING TIMESTAMP 19 WHERE A='ypo';
DELETE FROM amit.barak USING TIMESTAMP 20 WHERE A='jxb';
